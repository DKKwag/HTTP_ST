날짜 : 2023-03-27

태그 : #HTTP완벽가이드 #HTTP_웹의기초

# 3. HTTP 메시지
## 3.1 메시지의 흐름

- 메시지 - HTTP 애플리케이션 간에 주고받은 데이터의 블록
- 인바운드, 아웃바운드, 업스트림, 다운스트림은 메시지의 방향을 의미하는 용어

### 3.1.1 메시지는 원 서버 방향을 인바운드로 하여 송신된다.

- HTTP는 인바운드와 아웃바운드라는 용어를 트랜잭션 방향을 표현하기 위해 사용한다.
- 클라이언트 메시지 -> 서버 - 인바운드로 이동
- 서버 메시지 -> 클라이언트 - 아웃바운드 이동

### 3.1.2 다운스트림으로 흐르는 메시지

- 메시지는 결코 업스트림으로 흐르지 않는다.
- 클라이언트 -> 프락시 1, 2, 3 -> 서버 -> 프락시 3, 2, 1 클라이언트

## 3.2 메시지의 각 부분

- 시작줄 - 이것이 어떤 메시지 인지 서술
- 헤더 블록 - 속성
- 본문 - 데이터를 담고 있거나 없을 수 있다. (텍스트 or 이진 데이터)
- 시작줄과 헤더는 그냥 줄 단위로 분리된 아스키 문자열
	- 각 줄은 캐리지 리턴과 개행문자로 구성된 두 글자의줄바꿈 문자열로 끝난다.
	- 이 줄바꿈 문자열은 'CRLF'라 쓴다.
- 헤더는 본문에 대한 정보를 주기도 한다
	- Content Type - 본문이 무엇인지 말해줌
	- Content-Length - 본문의 크기를 말해줌

### 3.2.1 메시지 문법

- 요청 메시지의 형식
	- <메서드> <요청 URL> <버전>
	- <헤더>
	- <엔터티 본문>

- 응답 메시지의 형식
	- <버전> <상태코드> <사유구절>
	- <헤더>
	- <엔터티 본문>

- 메서드
	- 'HEAD', 'POST'와 같이 한 단어로 되어있음
- 요청 URL
	- 요청 대상이 되는 리소스를 지칭하는 완전한 URL 혹은 URL의 경로 구성요소
- 버전
	- 이 메시지에서 사용중인 HTTP버전
- 상태 코드
	- 요청 중에 무엇이 일어났는지 설명하는 세 자리의 숫자
	- 각 코드의 첫 번째 자릿수는 상태의 일반적인 분류('성공', '에러' 등)
- 사유 구절(reason-phrase)
	- 숫자로 된 상태 코드의 의미를 사람이 이해할 수 있게 설명해주는 짧은 문구
	- 오로지 사람에게 읽히기 위한 목적으로만 존재
- 헤더들
	- 이름, 콜론(:), 선택적인 공백, 값, CRLF가 순서대로 나타나는 0개 이상의 헤더들
	- 헤더의 목록은 빈 줄로 끝나 헤더 목록의 끝과 엔터티 본문의 시작을 표시
- 엔터티 본문
	- 모든 메시지가 엔터티 본문을 갖는 것은 아니다.
	- 때때로 메시지는 CRLF로 끝나게 된다.
	- 엔터티 본문이 없어도 헤더는 항상 빈줄로 끝나야 한다.

### 3.2.2 시작줄

- 모든 HTTP 메시지는 시작줄로 시작한다.
- 요청줄
	- 서버에서 어떤 동작이 일어나야 하는지 설명해주는 메서드와 그 동작에 대한 대상을 지칭하는 요청 URL이 들어있다.
	- 모든 필드는 공백으로 구분된다.
- 응답줄
	- 수행 결과에 대한 상태 정보와 결과 데이터를 클라이언트에게 돌려준다.
	- HTTP버전, 숫자로 된 상태코드, 수행 상태에 대해 설명해주는 텍스트로 된 사유구절이 들어있다.
	- 모든 필드는 공백으로 구분된다.
- 메서드
	-  요청의 시작줄은 메서드로 시작, 서버에게 무엇을 해야하는지 말해준다.
	- GET - 서버에서 어떤 문서를 가져온다.
	- HEAD - 서버에서 어떤 문서에 대해 헤더만 가져온다.
	- POST - 서버가 처리해야 할 데이터를 보낸다.
	- PUT - 서버에 요청 메시지의 본문을 저장한다.
	- TRACE - 메시지가 프락시를 거쳐 서버에 도달하는 과정을 추적한다.
	- OPTIONS - 서버가 어떤 메서드를 수행 할 수 있는지 확인한다.
	- DELETE - 서버에서 문서를 제거한다.
- 상태코드
	- 클라이언트에게 무엇이 일어났는지 말해준다.
	- 상태코드는 각 응답 메시지의 시작줄에 담겨 반환된다.
	- 200 ~ 299(정의된 범위 200 ~ 206) 성공을 나타낸다.
	- 300 ~ 399(정의된 범위 300 ~ 305) 리소스가 옮겨졌음을 뜻한다.
	- 400 ~ 499(정의된 범위 400 ~ 415) 클라이언트가 잘못된 요청을 했음을 의미한다.
	- 500 ~ 599(정의된 범위 500 ~ 505) 서버에서 뭔가 실패했음을 의미한다.
- 사유 구절
	- 응답 시작줄의 마지막 구성요소
	- 사유 구절은 상태 코드와 일대일로 대응된다.
- 버전 번호
	- 버전 번호는 HTTP/x.y 형식으로 요청과 응답 메시지 양쪽에 모두 기술된다.

### 3.2.3 헤더

- 시작 줄 다음에 0개, 1개 혹은 여러개의 HTTP 헤더가 온다.
	- 헤더 분류
		- 일반 헤더 - 요청과 응답 양쪽에 모두 나타날 수 있다.
		- 요청 헤더 - 요청에 대한 부가 정보를 제공
		- 응답 헤더 - 응답에 대한 부가 정보를 제공
		- Entity 헤더 - 본문 크기와 콘텐츠, 혹은 리소스 그 자체를 서술
		- 확장 헤더 - 명세에 정의되지 않은 새로운 헤다
	- 각 헤더는 간단한 문법을 가지고있음
		- 이름 - 쉼표 - 공백(없어도 됨) - 필드 값 -  CRLF

### 3.2.4 엔터티 본문

- 선택적인 엔터티 본문
- ex) 이미지, 비디오, HTML 문서, 소프트웨어 애플리케이션, 신용카드 등등 여러종류의 디지털 데이터를 실어 나를 수 있다.

### 3.2.5 버전 0.9 메시지

- HTTP 프로토콜의 초기버전
- 요청은 메서드와 요청 URL
- 응답은 엔터티로만 되어있다.

## 3.3 메서드

- 모든 서버가 모든 메서드를 구현하지는 않는다.

### 3.3.1 안전한 메서드(Safe Method)

- GET, HEAD는 안전한 메서드라고 할 수 있는데, HTTP 요청의 결과로 서버에 어떤 작용도 없기 때문
- 안전한 메서드의 목적은, 서버에 어떤 영향을 줄 수 있는 안전하지 않은 메서드가 사용될 때 사용자들에게 그 사실을 알려주는 HTTP 애플리케이션을 만들 수 있도록 하는 것에 있다.

### 3.3.2 GET

- 서버에게 리소스를 달라고 요청하기 위해 쓰인다.

### 3.3.3 HEAD

- 정확히 GET처럼 행동하지만, 서버는 응답으로 헤더만을 돌려준다
- 엔터티 본문은 결코 반환되지 않는다.
	- 리소스를 가져오지 않고도 그에 대해 무엇인가(타입이라던가)를 알아낼 수 있다.
	- 응답의 상태 코드를 통해, 개체가 존재하는지 확인 할 수 있다.
	- 헤더를 확인하여 리소스가 변경 되었는지 검사할 수 있다.

### 3.3.4 PUT

- 서버가 요청의 본문을 가지고 요청 URL의 이름대로 새 문서를 만들거나, 이미 URL이 존재한다면 본문을 사용해서 교체하는 것

### 3.3.5 POST

- 서버에 입력 데이터를 전송하기 위해 설계되었다. (PUT은 서버에 있는 리소스에 데이터를 입력하기위해)

### 3.3.6 TRACE

- 클라이언트에게 자신의 요청이 서버에 도달했을 때 어떻게 보이게 되는지 알려준다.
- 주로 진단을 위해 사용된다, 예를 들면 요청이 의도한 요청/응답 연쇄를 거쳐가는지 검사 할 수 있다.
- 목적지 서버에서 '루프백(loopback)' 진단을 시작한다.
- 어떠한 엔터티 본문도 보낼 수 없다.

### 3.3.7 OPTIONS

- 서버에게 특정 리소스에 대해 어떤 메서드가 지원되는지 물어 볼 수 있다.
- 여러 리소스에 실제로 접근하지 않고도 그것들이 어떻게 접근하는 것이 최선인지 확인 할 수 있는 수단을 클라이언트 애플리케이션에 제공

### 3.3.8 DELETE

- 서버에게 요청 URL로 지정한 리소스를 삭제할 것을 요청한다.

### 3.3.9 확장 메서드

- 필요에 따라 확장해도 문제가 없도록 설계되어 있어, 새로 기능을 추가해도 과거에 구현된 소프트웨어들의 오동작을 유발하지 않는다.
- 확장 메서드의 일부
	- LOCK - 사용자가 리소스를 잠글 수 있게 해준다(문서를 편집하는 동안 다른 사람이 동시에 같은 문서를 편집하지 못하도록)
	- MKCOL - 사용자가 문서를 생성할 수 있게 해준다.
	- COPY - 서버에 있는 리소스를 복사한다.
	- MOVE - 서버에 있는 ㄹ소스를 옮긴다.

## 3.4 상태코드




연결 문서 : [[03장 HTTP 메시지]]